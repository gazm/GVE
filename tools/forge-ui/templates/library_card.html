<div class="library-card" data-id="{{ item.id }}" data-type="{{ library_type }}">
    <div class="card-preview">
        {% if library_type == 'geometry' %}
        <div class="preview-3d">◇</div>
        {% elif library_type == 'textures' %}
        <img src="{{ item.thumbnail_url or '/static/assets/placeholder.png' }}" alt="{{ item.name }}">
        {% elif library_type == 'materials' %}
        <div class="preview-material">◈</div>
        {% elif library_type == 'audio' %}
        <div class="preview-audio">♫</div>
        {% elif library_type == 'recipes' %}
        <div class="preview-recipe">▣</div>
        {% endif %}
    </div>
    
    <div class="card-body">
        <h3 class="card-name">{{ item.name }}</h3>
        <div class="card-tags">
            {% for tag in item.tags[:3] %}
            <span class="tag-mini">{{ tag }}</span>
            {% endfor %}
            {% if item.tags|length > 3 %}
            <span class="tag-more">+{{ item.tags|length - 3 }}</span>
            {% endif %}
        </div>
    </div>
    
    <div class="card-meta">
        <div class="card-rating">
            {% for i in range(5) %}
            <span class="star {{ 'filled' if i < item.rating|int else '' }}">★</span>
            {% endfor %}
        </div>
        <div class="card-stats">
            <span class="stat" title="Times used">{{ item.usage_count or 0 }}×</span>
            {% if item.cost is defined %}
            <span class="stat cost {{ 'free' if item.cost == 0 else '' }}">
                {{ '$' + '%.2f'|format(item.cost) if item.cost > 0 else 'Free' }}
            </span>
            {% endif %}
        </div>
    </div>
    
    <div class="card-actions">
        {% if library_type == 'recipes' %}
        <button class="btn-use" hx-post="/api/assets/from-recipe/{{ item.id }}" 
                hx-target="#card-chain" onclick="showPage('assets')">
            Use Recipe
        </button>
        {% else %}
        <button class="btn-add" title="Add to chain (fills first empty slot)" data-asset-id="{{ item.id }}" data-asset-name="{{ item.name|e }}" onclick="addToChain(this.dataset.assetId, this.dataset.assetName)">+</button>
        {% endif %}
        <button class="btn-preview" title="Preview (viewport only)"
                onclick="previewItem('{{ item.id }}', '{{ library_type }}')">
            Preview
        </button>
    </div>
</div>
